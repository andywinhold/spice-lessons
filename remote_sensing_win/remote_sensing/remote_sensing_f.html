<HTML>
<HEAD>
<TITLE> Remote Sensing Hands-On Lesson (FORTRAN) </TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">

<A NAME="top"></A>

<TABLE STYLE="text-align: left; margin-left: auto; margin-right: auto; width: 800px;" BORDER="0" CELLPADDING="5" CELLSPACING="2">
<TBODY>
<TR>
  <TD STYLE="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
  <DIV ALIGN="right">
    <SMALL><SMALL><a href="../index.html">Main Page</a></SMALL></SMALL>
  </DIV>
  <B>Remote Sensing Hands-On Lesson (FORTRAN)</B> </TD>
</TR>
<TR>
  <TD STYLE="vertical-align: top;">

<H2> Table of Contents
</H2>

<PRE>
   <A HREF="#Remote Sensing Hands-On Lesson (FORTRAN)">Remote Sensing Hands-On Lesson (FORTRAN)</A>
      <A HREF="#Overview">Overview</A>
      <A HREF="#Note About HTML Links">Note About HTML Links</A>
      <A HREF="#References">References</A>
         <A HREF="#Tutorials">Tutorials</A>
         <A HREF="#Required Readings">Required Readings</A>
         <A HREF="#The Permuted Index">The Permuted Index</A>
         <A HREF="#Source Code Header Comments">Source Code Header Comments</A>
      <A HREF="#Kernels Used">Kernels Used</A>
      <A HREF="#SPICE Modules Used">SPICE Modules Used</A>
   <A HREF="#Time Conversion (convtm)">Time Conversion (convtm)</A>
      <A HREF="#Task Statement">Task Statement</A>
      <A HREF="#Learning Goals">Learning Goals</A>
      <A HREF="#Approach">Approach</A>
      <A HREF="#Solution">Solution</A>
         <A HREF="#Solution Meta-Kernel">Solution Meta-Kernel</A>
         <A HREF="#Solution Source Code">Solution Source Code</A>
         <A HREF="#Solution Sample Output">Solution Sample Output</A>
   <A HREF="#Obtaining Target States and Positions (getsta)">Obtaining Target States and Positions (getsta)</A>
      <A HREF="#Task Statement0">Task Statement</A>
      <A HREF="#Learning Goals0">Learning Goals</A>
      <A HREF="#Approach0">Approach</A>
      <A HREF="#Solution0">Solution</A>
         <A HREF="#Solution Meta-Kernel0">Solution Meta-Kernel</A>
         <A HREF="#Solution Source Code0">Solution Source Code</A>
         <A HREF="#Solution Sample Output0">Solution Sample Output</A>
   <A HREF="#Spacecraft Orientation and Reference Frames (xform)">Spacecraft Orientation and Reference Frames (xform)</A>
      <A HREF="#Task Statement1">Task Statement</A>
      <A HREF="#Learning Goals1">Learning Goals</A>
      <A HREF="#Approach1">Approach</A>
      <A HREF="#Solution1">Solution</A>
         <A HREF="#Solution Meta-Kernel1">Solution Meta-Kernel</A>
         <A HREF="#Solution Source Code1">Solution Source Code</A>
         <A HREF="#Solution Sample Output1">Solution Sample Output</A>
   <A HREF="#Computing Sub-spacecraft and Sub-solar Points (subpts)">Computing Sub-spacecraft and Sub-solar Points (subpts)</A>
      <A HREF="#Task Statement2">Task Statement</A>
      <A HREF="#Learning Goals2">Learning Goals</A>
      <A HREF="#Approach2">Approach</A>
      <A HREF="#Solution2">Solution</A>
         <A HREF="#Solution Meta-Kernel2">Solution Meta-Kernel</A>
         <A HREF="#Solution Source Code2">Solution Source Code</A>
         <A HREF="#Solution Sample Output2">Solution Sample Output</A>
   <A HREF="#Intersecting Vectors with a Triaxial Ellipsoid (fovint)">Intersecting Vectors with a Triaxial Ellipsoid (fovint)</A>
      <A HREF="#Task Statement3">Task Statement</A>
      <A HREF="#Learning Goals3">Learning Goals</A>
      <A HREF="#Approach3">Approach</A>
      <A HREF="#Solution3">Solution</A>
         <A HREF="#Solution Meta-Kernel3">Solution Meta-Kernel</A>
         <A HREF="#Solution Source Code3">Solution Source Code</A>
         <A HREF="#Solution Sample Output3">Solution Sample Output</A>

</PRE>

<HR SIZE=3 NOSHADE>

<BR><BR>
<A NAME="Remote Sensing Hands-On Lesson (FORTRAN)"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H1> Remote Sensing Hands-On Lesson (FORTRAN)
</H1><HR SIZE=3 NOSHADE><P><BR><BR><BR>
   February 8, 2010
<P>
 
<BR><BR>
<A NAME="Overview"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Overview
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   In this lesson you will develop a series of simple programs that
   demonstrate the usage of SPICE to compute a variety of different
   geometric quantities applicable to experiments carried out by a remote
   sensing instrument flown on an interplanetary spacecraft. This
   particular lesson focuses on a framing camera flying on the Cassini
   spacecraft, but many of the concepts are easily extended and generalized
   to other scenarios.
<P>
 
<BR><BR>
<A NAME="Note About HTML Links"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Note About HTML Links
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   The HTML version of this lesson contains links pointing to various HTML
   documents provided with the Toolkit. All of these links are relative
   and, in order to function, require this document to be in a certain
   location in the Toolkit HTML documentation directory tree.
<P>
 
   In order for the links to be resolved, create a subdirectory called
   ``lessons'' under the ``doc/html'' directory of the Toolkit tree and
   copy this document to that subdirectory before loading it into a Web
   browser.
<P>
 
<BR><BR>
<A NAME="References"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> References
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
<BR><BR>
<A NAME="Tutorials"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Tutorials
</H3><P><BR><BR>
   The following SPICE tutorials are referred to by the discussions in this
   lesson:
<P>
 
<PRE>
   Name             Lesson steps/routines it describes
   ---------------  -----------------------------------------
   Time             Time Conversion
   SCLK and LSK     Time Conversion
   SPK              Obtaining Ephemeris Data
   Frames           Reference Frames
   Using Frames     Reference Frames
   PCK              Planetary Constants Data
   CK               Spacecraft Orientation Data
</PRE>
   These tutorials are available from the NAIF ftp server at JPL:
<P>
 
<PRE>
   http://naif.jpl.nasa.gov/naif/tutorials.html
</PRE>
<BR><BR>
<A NAME="Required Readings"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Required Readings
</H3><P><BR><BR>
   The Required Reading documents are provided with the Toolkit and are
   located under the ``toolkit/doc'' directory in the FORTRAN installation
   tree.
<P>
 
<PRE>
   Name             Lesson steps/routines that it describes
   ---------------  -----------------------------------------
   <a href="../req/time.html">time.req</a>         Time Conversion
   <a href="../req/sclk.html">sclk.req</a>         SCLK Time Conversion
   <a href="../req/spk.html">spk.req</a>          Obtaining Ephemeris Data
   <a href="../req/frames.html">frames.req</a>       Using Reference Frames
   <a href="../req/pck.html">pck.req</a>          Obtaining Planetary Constants Data
   <a href="../req/ck.html">ck.req</a>           Obtaining Spacecraft Orientation Data
   <a href="../req/naif_ids.html">naif_ids.req</a>     Determining Body ID Codes
</PRE>
<BR><BR>
<A NAME="The Permuted Index"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> The Permuted Index
</H3><P><BR><BR>
   Another useful document distributed with the Toolkit is the permuted
   index. This is located under the ``toolkit/doc'' directory in the
   FORTRAN installation tree.
<P>
 
   This text document provides a simple mechanism to discover what SPICE
   routines perform a particular function of interest as well as the name
   of the source module that contains the routine. This is particularly
   useful for FORTRAN programmers because some of the routines are entry
   points and, therefore, the name does not translate directly into the
   name of the source module that contains them.
<P>
 
<BR><BR>
<A NAME="Source Code Header Comments"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Source Code Header Comments
</H3><P><BR><BR>
   The most detailed specification of a given SPICE FORTRAN or C routine is
   contained in the header section of its source code. The source code is
   distributed with the Toolkit and is located under
   ``toolkit/src/spicelib'' in FORTRAN and under ``cspice/src/cspice'' in C
   Toolkits.
<P>
 
   For example the source code of the <a href="../spicelib/str2et.html">STR2ET</a>/str2et_c routine is
<P>
 
<PRE>
   toolkit/src/spicelib/str2et.for
</PRE>
   in the FORTRAN Toolkit and in
<P>
 
<PRE>
   cspice/src/cspice/str2et_c.c
</PRE>
   in the C Toolkit.
<P>
 
   Since some of the FORTRAN routines are entry points they are usually
   part of a source file that has different name. The ``Permuted Index''
   document mentioned above can be used to locate the name of their source
   file.
<P>
 
<BR><BR>
<A NAME="Kernels Used"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Kernels Used
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   The following kernels are used in examples provided in this lesson:
<P>
 
<PRE>
   #  FILE NAME                 TYPE  DESCRIPTION
   -- ------------------------- ----  ------------------------
   1  naif0008.tls              LSK   Generic LSK
   2  cas00084.tsc              SCLK  Cassini SCLK
   3  981005_PLTEPH-DE405S.bsp  SPK   Solar System Ephemeris
   4  020514_SE_SAT105.bsp      SPK   Saturnian Satellite Ephemeris
   5  030201AP_SK_SM546_T45.bsp SPK   Cassini Spacecraft SPK
   6  cas_v37.tf                FK    Cassini FK
   7  04135_04171pc_psiv2.bc    CK    Cassini Spacecraft CK
   8  cpck05Mar2004.tpc         PCK   Cassini Project PCK
   9  cas_iss_v09.ti            IK    ISS Instrument Kernel
</PRE>
   These SPICE kernels are included in the lesson package available from
   the NAIF server at JPL:
<P>
 
<PRE>
   ftp://naif.jpl.nasa.gov/pub/naif/toolkit_docs/Lessons/
</PRE>
<BR><BR>
<A NAME="SPICE Modules Used"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> SPICE Modules Used
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   This section provides a complete summary of the routines, and the
   kernels that are suggested for usage in each of the exercises in this
   tutorial. (You may wish to not look at this list unless/until you ``get
   stuck'' while working on your own.)
<P>
 
<PRE>
   CHAPTER EXERCISE   ROUTINES   FUNCTIONS  KERNELS
   ------- ---------  ---------  ---------  ---------
     1     convtm     <a href="../spicelib/furnsh.html">FURNSH</a>                1,2
                      PROMPT
                      <a href="../spicelib/str2et.html">STR2ET</a>
                      <a href="../spicelib/etcal.html">ETCAL</a>
                      <a href="../spicelib/timout.html">TIMOUT</a>
                      <a href="../spicelib/sce2c.html">SCE2C</a>
                      <a href="../spicelib/sce2s.html">SCE2S</a>
 
     2     getsta     <a href="../spicelib/furnsh.html">FURNSH</a>     <a href="../spicelib/vnorm.html">VNORM</a>      1,3-5
                      PROMPT
                      <a href="../spicelib/str2et.html">STR2ET</a>
                      <a href="../spicelib/spkezr.html">SPKEZR</a>
                      <a href="../spicelib/spkpos.html">SPKPOS</a>
                      <a href="../spicelib/convrt.html">CONVRT</a>
 
     3     xform      <a href="../spicelib/furnsh.html">FURNSH</a>     <a href="../spicelib/vsep.html">VSEP</a>       1-8
                      PROMPT
                      <a href="../spicelib/str2et.html">STR2ET</a>
                      <a href="../spicelib/spkezr.html">SPKEZR</a>
                      <a href="../spicelib/sxform.html">SXFORM</a>
                      <a href="../spicelib/mxvg.html">MXVG</a>
                      <a href="../spicelib/spkpos.html">SPKPOS</a>
                      <a href="../spicelib/pxform.html">PXFORM</a>
                      <a href="../spicelib/mxv.html">MXV</a>
                      <a href="../spicelib/convrt.html">CONVRT</a>
 
     4     subpts     <a href="../spicelib/furnsh.html">FURNSH</a>                1,3-5,8
                      PROMPT
                      <a href="../spicelib/str2et.html">STR2ET</a>
                      <a href="../spicelib/subpt.html">SUBPT</a>
                      <a href="../spicelib/subsol.html">SUBSOL</a>
 
     5     fovint     <a href="../spicelib/furnsh.html">FURNSH</a>     <a href="../spicelib/dpr.html">DPR</a>        1-9
                      PROMPT
                      <a href="../spicelib/str2et.html">STR2ET</a>
                      <a href="../spicelib/bodn2c.html">BODN2C</a>
                      BYEBYE
                      <a href="../spicelib/getfov.html">GETFOV</a>
                      <a href="../spicelib/sincpt.html">SINCPT</a>
                      <a href="../spicelib/reclat.html">RECLAT</a>
                      <a href="../spicelib/ilumin.html">ILUMIN</a>
                      <a href="../spicelib/et2lst.html">ET2LST</a>
</PRE>
   Refer to the headers of the various routines listed above, as detailed
   interface specifications are provided with the source code.
<P>
 
<BR><BR>
<A NAME="Time Conversion (convtm)"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H1> Time Conversion (convtm)
</H1><HR SIZE=3 NOSHADE><P><BR><BR><BR>
<BR><BR>
<A NAME="Task Statement"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Task Statement
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   Write a program that prompts the user for an input UTC time string,
   converts it to the following time systems and output formats:
<P>
 
<UL>
<TT>1.</TT> Ephemeris Time (ET) in seconds past J2000
<BR><BR></UL>
<UL>
<TT>2.</TT> Calendar Ephemeris Time
<BR><BR></UL>
<UL>
<TT>3.</TT> Spacecraft Clock Time
<BR><BR></UL>
   and displays the results. Use the program to convert "2004 jun 11
   19:32:00" UTC into these alternate systems.
<P>
 
<BR><BR>
<A NAME="Learning Goals"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Learning Goals
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   Familiarity with the various time conversion and parsing routines
   available in the Toolkit. Exposure to source code headers and their
   usage in learning to call routines.
<P>
 
<BR><BR>
<A NAME="Approach"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Approach
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   The solution to the problem can be broken down into a series of simple
   steps:
<P>
 
<UL>
<TT>--</TT> Decide which SPICE kernels are necessary. Prepare a meta-kernel listing the
kernels and load it into the program.
<BR><BR></UL>
<UL>
<TT>--</TT> Prompt the user for an input UTC time string.
<BR><BR></UL>
<UL>
<TT>--</TT> Convert the input time string into ephemeris time expressed as seconds past
J2000 TDB. Display the result.
<BR><BR></UL>
<UL>
<TT>--</TT> Convert ephemeris time into a calendar format. Display the result.
<BR><BR></UL>
<UL>
<TT>--</TT> Convert ephemeris time into a spacecraft clock string. Display the result.
<BR><BR></UL>
   You may find it useful to consult the permuted index, the headers of
   various source modules, and the ``Time Required Reading'' (<a href="../req/time.html">time.req</a>) and
   ``SCLK Required Reading'' (<a href="../req/sclk.html">sclk.req</a>) documents.
<P>
 
   When completing the ``calendar format'' step above, consider using one
   of two possible methods: <a href="../spicelib/etcal.html">ETCAL</a> or <a href="../spicelib/timout.html">TIMOUT</a>.
<P>
 
<BR><BR>
<A NAME="Solution"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Solution
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
<BR><BR>
<A NAME="Solution Meta-Kernel"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Meta-Kernel
</H3><P><BR><BR>
   The meta-kernel we created for the solution to this exercise is named
   'convtm.tm'. Its contents follow:
<P>
 
<PRE>
   KPL/MK
 
   This is the meta-kernel used in the solution of the ``Time
   Conversion'' task in the Remote Sensing Hands On Lesson.
 
      \begindata
      KERNELS_TO_LOAD = ( 'kernels/lsk/naif0008.tls',
                          'kernels/sclk/cas00084.tsc' )
      \begintext
 
 
</PRE>
<BR><BR>
<A NAME="Solution Source Code"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Source Code
</H3><P><BR><BR>
   A sample solution to the problem follows:
<P>
 
<PRE>
         PROGRAM CONVTM
 
         IMPLICIT NONE
 
   C
   C     Local Parameters
   C
   C     The name of the meta-kernel that lists the kernels
   C     to load into the program.
   C
         CHARACTER*(*)         METAKR
         PARAMETER           ( METAKR = 'convtm.tm' )
 
   C
   C     The spacecraft clock ID code for CASSINI.
   C
         INTEGER               SCLKID
         PARAMETER           ( SCLKID = -82 )
 
   C
   C     The length of various string variables.
   C
         INTEGER               STRLEN
         PARAMETER           ( STRLEN = 50 )
 
   C
   C     Local Variables
   C
         CHARACTER*(STRLEN)    CALET
         CHARACTER*(STRLEN)    SCLKST
         CHARACTER*(STRLEN)    UTCTIM
 
         DOUBLE PRECISION      ET
 
   C
   C     Load the kernels this program requires.
   C     Both the spacecraft clock kernel and a
   C     leapseconds kernel should be listed
   C     in the meta-kernel.
   C
         CALL <a href="../spicelib/furnsh.html">FURNSH</a> ( METAKR )
 
   C
   C     Prompt the user for the input time string.
   C
         CALL PROMPT ( 'Input UTC Time: ', UTCTIM )
 
         WRITE (*,*) 'Converting UTC Time: ', UTCTIM
 
   C
   C     Convert UTCTIM to ET.
   C
         CALL <a href="../spicelib/str2et.html">STR2ET</a> ( UTCTIM, ET )
 
         WRITE (*,'(A,F16.3)') '   ET Seconds Past J2000: ', ET
 
   C
   C     Now convert ET to a formal calendar time
   C     string.  This can be accomplished in two
   C     ways.
   C
         CALL <a href="../spicelib/etcal.html">ETCAL</a> ( ET, CALET )
 
         WRITE (*,*) '   Calendar ET (<a href="../spicelib/etcal.html">ETCAL</a>): ', CALET
 
   C
   C     Or use <a href="../spicelib/timout.html">TIMOUT</a> for finer control over the
   C     output format.  The picture below was built
   C     by examining the header of <a href="../spicelib/timout.html">TIMOUT</a>.
   C
         CALL <a href="../spicelib/timout.html">TIMOUT</a> ( ET, 'YYYY-MON-DDTHR:MN:SC ::TDB', CALET )
 
         WRITE (*,*) '   Calendar ET (<a href="../spicelib/timout.html">TIMOUT</a>): ', CALET
 
   C
   C     Convert ET to spacecraft clock time.
   C
         CALL <a href="../spicelib/sce2s.html">SCE2S</a> ( SCLKID, ET, SCLKST )
 
         WRITE (*,*) '   Spacecraft Clock Time: ', SCLKST
 
         END
</PRE>
<BR><BR>
<A NAME="Solution Sample Output"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Sample Output
</H3><P><BR><BR>
   After compiling the program, execute it:
<P>
 
<PRE>
   Converting UTC Time: 2004 jun 11 19:32:00
      ET Seconds Past J2000:    140254384.185
       Calendar ET (<a href="../spicelib/etcal.html">ETCAL</a>): 2004 JUN 11 19:33:04.184
       Calendar ET (<a href="../spicelib/timout.html">TIMOUT</a>): 2004-JUN-11T19:33:04
       Spacecraft Clock Time: 1/1465674964.105
</PRE>
<BR><BR>
<A NAME="Obtaining Target States and Positions (getsta)"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H1> Obtaining Target States and Positions (getsta)
</H1><HR SIZE=3 NOSHADE><P><BR><BR><BR>
<BR><BR>
<A NAME="Task Statement0"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Task Statement
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   Write a program that prompts the user for an input UTC time string,
   computes the following quantities at that epoch:
<P>
 
<UL>
<TT>1.</TT> The apparent state of Phoebe as seen from CASSINI in the J2000 frame, in
kilometers and kilometers/second. This vector itself is not of any
particular interest, but it is a useful intermediate quantity in some
geometry calculations.
<BR><BR></UL>
<UL>
<TT>2.</TT> The apparent position of the Earth as seen from CASSINI in the J2000 frame,
in kilometers.
<BR><BR></UL>
<UL>
<TT>3.</TT> The one-way light time between CASSINI and the apparent position of Earth,
in seconds.
<BR><BR></UL>
<UL>
<TT>4.</TT> The apparent position of the Sun as seen from Phoebe in the J2000 frame
(J2000), in kilometers.
<BR><BR></UL>
<UL>
<TT>5.</TT> The actual (geometric) distance between the Sun and Phoebe, in astronomical
units.
<BR><BR></UL>
   and displays the results. Use the program to compute these quantities at
   "2004 jun 11 19:32:00" UTC.
<P>
 
<BR><BR>
<A NAME="Learning Goals0"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Learning Goals
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   Understand the anatomy of an <a href="../spicelib/spkezr.html">SPKEZR</a> call. Discover the difference
   between <a href="../spicelib/spkezr.html">SPKEZR</a> and <a href="../spicelib/spkpos.html">SPKPOS</a>. Familiarity with the Toolkit utility
   ``brief''. Exposure to unit conversion with SPICE.
<P>
 
<BR><BR>
<A NAME="Approach0"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Approach
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   The solution to the problem can be broken down into a series of simple
   steps:
<P>
 
<UL>
<TT>--</TT> Decide which SPICE kernels are necessary. Prepare a meta-kernel listing the
kernels and load it into the program.
<BR><BR></UL>
<UL>
<TT>--</TT> Prompt the user for an input time string.
<BR><BR></UL>
<UL>
<TT>--</TT> Convert the input time string into ephemeris time expressed as seconds past
J2000 TDB.
<BR><BR></UL>
<UL>
<TT>--</TT> Compute the state of Phoebe relative to CASSINI in the J2000 reference
frame, corrected for aberrations.
<BR><BR></UL>
<UL>
<TT>--</TT> Compute the position of Earth relative to CASSINI in the J2000 reference
frame, corrected for aberrations. (The routine in the library that computes
this also returns the one-way light time between CASSINI and Earth.)
<BR><BR></UL>
<UL>
<TT>--</TT> Compute the position of the Sun relative to Phoebe in the J2000 reference
frame, corrected for aberrations.
<BR><BR></UL>
<UL>
<TT>--</TT> Compute the position of the Sun relative to Phoebe without correcting for
aberration.
<BR><BR></UL>
<UL>
<TT>--</TT> Compute the length of this vector. This provides the desired distance in
kilometers.
<BR><BR></UL>
<UL>
<TT>--</TT> Convert the distance in kilometers into AU.
<BR><BR></UL>
   You may find it useful to consult the permuted index, the headers of
   various source modules, and the ``SPK Required Reading'' (<a href="../req/spk.html">spk.req</a>)
   document.
<P>
 
   When deciding which SPK files to load, the Toolkit utility ``brief'' may
   be of some use.
<P>
 
   ``brief'' is located in the ``toolkit/exe'' directory for FORTRAN
   toolkits. Consult its user's guide available in ``toolkit/doc/<a href="../ug/brief.html">brief.ug</a>''
   for details.
<P>
 
<BR><BR>
<A NAME="Solution0"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Solution
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
<BR><BR>
<A NAME="Solution Meta-Kernel0"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Meta-Kernel
</H3><P><BR><BR>
   The meta-kernel we created for the solution to this exercise is named
   'getsta.tm'. Its contents follow:
<P>
 
<PRE>
   KPL/MK
 
   This is the meta-kernel used in the solution of the
   ``Obtaining Target States and Positions'' task in the
   Remote Sensing Hands On Lesson.
 
      \begindata
      KERNELS_TO_LOAD = ( 'kernels/lsk/naif0008.tls',
                          'kernels/spk/981005_PLTEPH-DE405S.bsp',
                          'kernels/spk/020514_SE_SAT105.bsp',
                          'kernels/spk/030201AP_SK_SM546_T45.bsp' )
      \begintext
</PRE>
<BR><BR>
<A NAME="Solution Source Code0"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Source Code
</H3><P><BR><BR>
   A sample solution to the problem follows:
<P>
 
<PRE>
         PROGRAM GETSTA
 
         IMPLICIT NONE
 
   C
   C     SPICELIB Functions
   C
         DOUBLE PRECISION      <a href="../spicelib/vnorm.html">VNORM</a>
 
   C
   C     Local Parameters
   C
   C
   C     The name of the meta-kernel that lists the kernels
   C     to load into the program.
   C
         CHARACTER*(*)         METAKR
         PARAMETER           ( METAKR = 'getsta.tm' )
 
   C
   C     The length of various string variables.
   C
         INTEGER               STRLEN
         PARAMETER           ( STRLEN = 50 )
 
   C
   C     Local Variables
   C
         CHARACTER*(STRLEN)    UTCTIM
 
         DOUBLE PRECISION      DIST
         DOUBLE PRECISION      ET
         DOUBLE PRECISION      <a href="../spicelib/ltime.html">LTIME</a>
         DOUBLE PRECISION      POS   ( 3 )
         DOUBLE PRECISION      STATE ( 6 )
 
   C
   C     Load the kernels that this program requires.  We
   C     will need a leapseconds kernel to convert input
   C     UTC time strings into ET.  We also will need the
   C     necessary SPK files with coverage for the bodies
   C     in which we are interested.
   C
         CALL <a href="../spicelib/furnsh.html">FURNSH</a> ( METAKR )
 
   C
   C     Prompt the user for the input time string.
   C
         CALL PROMPT ( 'Input UTC Time: ', UTCTIM )
 
         WRITE (*,*) 'Converting UTC Time: ', UTCTIM
 
   C
   C     Convert UTCTIM to ET.
   C
         CALL <a href="../spicelib/str2et.html">STR2ET</a> ( UTCTIM, ET )
 
         WRITE (*,'(A,F16.3)') '   ET seconds past J2000: ', ET
 
   C
   C     Compute the apparent state of Phoebe as seen from
   C     CASSINI in the J2000 frame.  All of the ephemeris
   C     readers return states in units of kilometers and
   C     kilometers per second.
   C
         CALL <a href="../spicelib/spkezr.html">SPKEZR</a> ( 'PHOEBE', ET,    'J2000', 'LT+S',
        .              'CASSINI',  STATE, <a href="../spicelib/ltime.html">LTIME</a>               )
 
         WRITE (*,*) '   Apparent state of Phoebe as seen from '
        .//          'CASSINI in the J2000'
         WRITE (*,*) '      frame (km, km/s):'
 
         WRITE (*,'(A,F16.3)') '      X = ', STATE(1)
         WRITE (*,'(A,F16.3)') '      Y = ', STATE(2)
         WRITE (*,'(A,F16.3)') '      Z = ', STATE(3)
         WRITE (*,'(A,F16.3)') '     VX = ', STATE(4)
         WRITE (*,'(A,F16.3)') '     VY = ', STATE(5)
         WRITE (*,'(A,F16.3)') '     VZ = ', STATE(6)
 
   C
   C     Compute the apparent position of Earth as seen from
   C     CASSINI in the J2000 frame.  Note: We could have continued
   C     using <a href="../spicelib/spkezr.html">SPKEZR</a> and simply ignored the velocity components.
   C
         CALL <a href="../spicelib/spkpos.html">SPKPOS</a> ( 'EARTH', ET,  'J2000', 'LT+S',
        .              'CASSINI',   POS, <a href="../spicelib/ltime.html">LTIME</a>               )
 
         WRITE (*,*) '   Apparent position of Earth as seen from '
        .//          'CASSINI in the J2000'
         WRITE (*,*) '      frame (km):'
 
         WRITE (*,'(A,F16.3)') '      X = ', POS(1)
         WRITE (*,'(A,F16.3)') '      Y = ', POS(2)
         WRITE (*,'(A,F16.3)') '      Z = ', POS(3)
 
   C
   C     We need only display <a href="../spicelib/ltime.html">LTIME</a>, as it is precisely the light
   C     time in which we are interested.
   C
         WRITE (*,*) '   One way light time between CASSINI and the '
        .//          'apparent position'
         WRITE (*,'(A,F16.3)') '      of Earth (seconds): ', <a href="../spicelib/ltime.html">LTIME</a>
 
   C
   C     Compute the apparent position of the Sun as seen from
   C     Phoebe in the J2000 frame.
   C
         CALL <a href="../spicelib/spkpos.html">SPKPOS</a> ( 'SUN',  ET,  'J2000', 'LT+S',
        .              'PHOEBE', POS, <a href="../spicelib/ltime.html">LTIME</a>                    )
 
         WRITE (*,*) '   Apparent position of Sun as seen from '
        .//          'Phoebe in the'
         WRITE (*,*) '      J2000 frame (km):'
 
         WRITE (*,'(A,F16.3)') '      X = ', POS(1)
         WRITE (*,'(A,F16.3)') '      Y = ', POS(2)
         WRITE (*,'(A,F16.3)') '      Z = ', POS(3)
 
   C
   C     Now we need to compute the actual distance between the Sun
   C     and Phoebe.  The above <a href="../spicelib/spkpos.html">SPKPOS</a> call gives us the apparent
   C     distance, so we need to adjust our aberration correction
   C     appropriately.
   C
         CALL <a href="../spicelib/spkpos.html">SPKPOS</a> ( 'SUN',  ET,  'J2000', 'NONE',
        .              'PHOEBE', POS, <a href="../spicelib/ltime.html">LTIME</a>                  )
 
   C
   C     Compute the distance between the body centers in
   C     kilometers.
   C
         DIST = <a href="../spicelib/vnorm.html">VNORM</a>(POS)
 
   C
   C     Convert this value to AU using <a href="../spicelib/convrt.html">CONVRT</a>.
   C
         CALL <a href="../spicelib/convrt.html">CONVRT</a> ( DIST, 'KM', 'AU', DIST )
 
         WRITE (*,*) '   Actual distance between Sun and Phoebe body '
        .//          'centers: '
         WRITE (*,'(A,F16.3)') '      (AU):', DIST
 
         END
</PRE>
<BR><BR>
<A NAME="Solution Sample Output0"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Sample Output
</H3><P><BR><BR>
   After compiling the program, execute it:
<P>
 
<PRE>
   Converting UTC Time: 2004 JUN 11 19:32:00
      ET seconds past J2000:    140254384.185
       Apparent state of Phoebe as seen from CASSINI in the J2000
          frame (km, km/s):
         X =         -119.921
         Y =         2194.139
         Z =          -57.639
        VX =           -5.980
        VY =           -2.119
        VZ =           -0.295
       Apparent position of Earth as seen from CASSINI in the J2000
          frame (km):
         X =    353019393.123
         Y =  -1328180352.140
         Z =   -568134171.697
       One way light time between CASSINI and the apparent position
         of Earth (seconds):         4960.427
       Apparent position of Sun as seen from Phoebe in the
          J2000 frame (km):
         X =    376551465.272
         Y =  -1190495630.303
         Z =   -508438699.110
       Actual distance between Sun and Phoebe body centers:
         (AU):           9.012
</PRE>
<BR><BR>
<A NAME="Spacecraft Orientation and Reference Frames (xform)"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H1> Spacecraft Orientation and Reference Frames (xform)
</H1><HR SIZE=3 NOSHADE><P><BR><BR><BR>
<BR><BR>
<A NAME="Task Statement1"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Task Statement
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   Write a program that prompts the user for an input time string, computes
   and displays the following at the epoch of interest:
<P>
 
<UL>
<TT>1.</TT> The apparent state of Phoebe as seen from CASSINI in the IAU_PHOEBE
body-fixed frame. This vector itself is not of any particular interest, but
it is a useful intermediate quantity in some geometry calculations.
<BR><BR></UL>
<UL>
<TT>2.</TT> The angular separation between the apparent position of Earth as seen from
CASSINI and the nominal boresight of the CASSINI high gain antenna (HGA).
<BR><BR></UL>
<UL>
<TT>&#32;&#32;</TT> The HGA boresight direction is provided by the kernel variable
TKFRAME_-82101_BORESIGHT, which is defined in the Cassini frame kernel
cited above in the section ``Kernels Used.'' In this kernel, the HGA
boresight vector is expressed relative to the CASSINI_HGA reference frame.
<BR><BR></UL>
   Use the program to compute these quantities at the epoch "2004 jun 11
   19:32:00" UTC.
<P>
 
<BR><BR>
<A NAME="Learning Goals1"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Learning Goals
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   Familiarity with the different types of kernels involved in chaining
   reference frames together, both inertial and non-inertial. Discover some
   of the matrix and vector math routines. Understand the difference
   between <a href="../spicelib/pxform.html">PXFORM</a> and <a href="../spicelib/sxform.html">SXFORM</a>.
<P>
 
<BR><BR>
<A NAME="Approach1"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Approach
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   The solution to the problem can be broken down into a series of simple
   steps:
<P>
 
<UL>
<TT>--</TT> Decide which SPICE kernels are necessary. Prepare a meta-kernel listing the
kernels and load it into the program.
<BR><BR></UL>
<UL>
<TT>--</TT> Prompt the user for an input time string.
<BR><BR></UL>
<UL>
<TT>--</TT> Convert the input time string into ephemeris time expressed as seconds past
J2000 TDB.
<BR><BR></UL>
<UL>
<TT>--</TT> Compute the state of Phoebe relative to CASSINI in the J2000 reference
frame, corrected for aberrations.
<BR><BR></UL>
<UL>
<TT>--</TT> Compute the state transformation matrix from J2000 to IAU_PHOEBE at the
epoch, adjusted for light time.
<BR><BR></UL>
<UL>
<TT>--</TT> Multiply the state of Phoebe relative to CASSINI in the J2000 reference
frame by the state transformation matrix computed in the previous step.
<BR><BR></UL>
<UL>
<TT>--</TT> Compute the position of Earth relative to CASSINI in the J2000 reference
frame, corrected for aberrations.
<BR><BR></UL>
<UL>
<TT>--</TT> Determine what the nominal boresight of the CASSINI high gain antenna is by
examining the frame kernel's content.
<BR><BR></UL>
<UL>
<TT>--</TT> Compute the rotation matrix from the CASSINI high gain antenna frame to
J2000.
<BR><BR></UL>
<UL>
<TT>--</TT> Multiply the nominal boresight expressed in the CASSINI high gain antenna
frame by the rotation matrix from the previous step.
<BR><BR></UL>
<UL>
<TT>--</TT> Compute the separation between the result of the previous step and the
apparent position of the Earth relative to CASSINI in the J2000 frame.
<BR><BR></UL>
   HINT: Several of the steps above may be compressed into a single using
   SPICE routines with which you are already familiar. The ``long-way''
   presented above is intended to facilitate the introduction of the
   routines <a href="../spicelib/pxform.html">PXFORM</a> and <a href="../spicelib/sxform.html">SXFORM</a>.
<P>
 
   You may find it useful to consult the permuted index, the headers of
   various source modules, and the following toolkit documentation:
<P>
 
<UL>
<TT>1.</TT> Frames Required Reading (<a href="../req/frames.html">frames.req</a>)
<BR><BR></UL>
<UL>
<TT>2.</TT> PCK Required Reading (<a href="../req/pck.html">pck.req</a>)
<BR><BR></UL>
<UL>
<TT>3.</TT> SPK Required Reading (<a href="../req/spk.html">spk.req</a>)
<BR><BR></UL>
<UL>
<TT>4.</TT> CK Required Reading (<a href="../req/ck.html">ck.req</a>)
<BR><BR></UL>
   This particular example makes use of many of the different types of
   SPICE kernels. You should spend a few moments thinking about which
   kernels you will need and what data they provide.
<P>
 
<BR><BR>
<A NAME="Solution1"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Solution
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
<BR><BR>
<A NAME="Solution Meta-Kernel1"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Meta-Kernel
</H3><P><BR><BR>
   The meta-kernel we created for the solution to this exercise is named
   'xform.tm'. Its contents follow:
<P>
 
<PRE>
   KPL/MK
 
   This is the meta-kernel used in the solution of the ``Spacecraft
   Orientation and Reference Frames'' task in the Remote Sensing
   Hands On Lesson.
 
      \begindata
      KERNELS_TO_LOAD = ( 'kernels/lsk/naif0008.tls',
                          'kernels/sclk/cas00084.tsc',
                          'kernels/spk/981005_PLTEPH-DE405S.bsp',
                          'kernels/spk/020514_SE_SAT105.bsp',
                          'kernels/spk/030201AP_SK_SM546_T45.bsp',
                          'kernels/fk/cas_v37.tf',
                          'kernels/ck/04135_04171pc_psiv2.bc',
                          'kernels/pck/cpck05Mar2004.tpc' )
      \begintext
</PRE>
<BR><BR>
<A NAME="Solution Source Code1"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Source Code
</H3><P><BR><BR>
   A sample solution to the problem follows:
<P>
 
<PRE>
         PROGRAM XFORM
 
         IMPLICIT NONE
 
   C
   C     SPICELIB Functions
   C
         DOUBLE PRECISION      <a href="../spicelib/vsep.html">VSEP</a>
 
   C
   C     Local Parameters
   C
   C
   C     The name of the meta-kernel that lists the kernels
   C     to load into the program.
   C
         CHARACTER*(*)         METAKR
         PARAMETER           ( METAKR = 'xform.tm' )
 
   C
   C     The length of various string variables.
   C
         INTEGER               STRLEN
         PARAMETER           ( STRLEN = 50 )
 
   C
   C     Local Variables
   C
         CHARACTER*(STRLEN)    UTCTIM
 
         DOUBLE PRECISION      ET
         DOUBLE PRECISION      <a href="../spicelib/ltime.html">LTIME</a>
         DOUBLE PRECISION      STATE  ( 6 )
         DOUBLE PRECISION      BFIXST ( 6 )
         DOUBLE PRECISION      POS    ( 3 )
         DOUBLE PRECISION      SXFMAT ( 6, 6 )
         DOUBLE PRECISION      PFORM  ( 3, 3 )
         DOUBLE PRECISION      BSIGHT ( 3 )
         DOUBLE PRECISION      SEP
 
   C
   C     Load the kernels that this program requires.  We
   C     will need:
   C
   C        A leapseconds kernel
   C        A spacecraft clock kernel for CASSINI
   C        The necessary ephemerides
   C        A planetary constants file (PCK)
   C        A spacecraft orientation kernel for CASSINI (CK)
   C        A frame kernel (TF)
   C
         CALL <a href="../spicelib/furnsh.html">FURNSH</a> ( METAKR )
 
   C
   C     Prompt the user for the input time string.
   C
         CALL PROMPT ( 'Input UTC Time: ', UTCTIM )
 
         WRITE (*,*) 'Converting UTC Time: ', UTCTIM
 
   C
   C     Convert UTCTIM to ET.
   C
         CALL <a href="../spicelib/str2et.html">STR2ET</a> ( UTCTIM, ET )
 
         WRITE (*,'(A,F16.3)') '   ET seconds past J2000: ', ET
 
   C
   C     Compute the apparent state of Phoebe as seen from CASSINI
   C     in the J2000 reference frame.
   C
         CALL <a href="../spicelib/spkezr.html">SPKEZR</a> ( 'PHOEBE',   ET,    'J2000', 'LT+S',
        .              'CASSINI',  STATE, <a href="../spicelib/ltime.html">LTIME</a>           )
 
   C
   C     Now obtain the transformation from the inertial
   C     J2000 frame to the non-inertial, body-fixed IAU_PHOEBE
   C     frame. Since we'll use this transformation to produce
   C     the apparent state in the IAU_PHOEBE reference frame,
   C     we need to correct the orientation of this frame for
   C     one-way light time; hence we subtract <a href="../spicelib/ltime.html">LTIME</a> from ET
   C     in the call below.
   C
         CALL <a href="../spicelib/sxform.html">SXFORM</a> ( 'J2000', 'IAU_PHOEBE', ET-<a href="../spicelib/ltime.html">LTIME</a>, SXFMAT )
 
   C
   C     Now transform the apparent J2000 state into IAU_PHOEBE
   C     with the following matrix multiplication:
   C
         CALL <a href="../spicelib/mxvg.html">MXVG</a> ( SXFMAT, STATE, 6, 6, BFIXST )
 
   C
   C     Display the results.
   C
         WRITE (*,*) '   Apparent state of Phoebe as seen from '
        .//          'CASSINI in the IAU_PHOEBE'
         WRITE (*,*) '      body-fixed frame (km, km/s):'
         WRITE (*,'(A,F19.6)') '      X = ', BFIXST(1)
         WRITE (*,'(A,F19.6)') '      Y = ', BFIXST(2)
         WRITE (*,'(A,F19.6)') '      Z = ', BFIXST(3)
         WRITE (*,'(A,F19.6)') '     VX = ', BFIXST(4)
         WRITE (*,'(A,F19.6)') '     VY = ', BFIXST(5)
         WRITE (*,'(A,F19.6)') '     VZ = ', BFIXST(6)
 
   C
   C     It is worth pointing out, all of the above could have
   C     been done with a single call to <a href="../spicelib/spkezr.html">SPKEZR</a>:
   C
         CALL <a href="../spicelib/spkezr.html">SPKEZR</a> ( 'PHOEBE', ET,    'IAU_PHOEBE', 'LT+S',
        .              'CASSINI',  STATE, <a href="../spicelib/ltime.html">LTIME</a>               )
 
   C
   C     Display the results.
   C
         WRITE (*,*) '   Apparent state of Phoebe as seen from CASSINI '
        .//          'in the IAU_PHOEBE'
         WRITE (*,*) '      body-fixed frame (km, km/s) '
        .//          'obtained using <a href="../spicelib/spkezr.html">SPKEZR</a> directly:'
         WRITE (*,'(A,F19.6)') '      X = ', STATE(1)
         WRITE (*,'(A,F19.6)') '      Y = ', STATE(2)
         WRITE (*,'(A,F19.6)') '      Z = ', STATE(3)
         WRITE (*,'(A,F19.6)') '     VX = ', STATE(4)
         WRITE (*,'(A,F19.6)') '     VY = ', STATE(5)
         WRITE (*,'(A,F19.6)') '     VZ = ', STATE(6)
 
   C
   C     Note that the velocity found by using <a href="../spicelib/spkezr.html">SPKEZR</a>
   C     to compute the state in the IAU_PHOEBE frame differs
   C     at the few mm/second level from that found previously
   C     by calling <a href="../spicelib/spkezr.html">SPKEZR</a> and then <a href="../spicelib/sxform.html">SXFORM</a>. Computing velocity
   C     via a single call to <a href="../spicelib/spkezr.html">SPKEZR</a> as we've done immediately
   C     above is slightly more accurate because it accounts for
   C     the effect of the rate of change of light time on the
   C     apparent angular velocity of the target's body-fixed
   C     reference frame.
   C
   C     Now we are to compute the angular separation between
   C     the apparent position of the Earth as seen from the
   C     orbiter and the nominal boresight of the high gain
   C     antenna.  First, compute the apparent position of
   C     the Earth as seen from CASSINI in the J2000 frame.
   C
         CALL <a href="../spicelib/spkpos.html">SPKPOS</a> ( 'EARTH', ET,  'J2000', 'LT+S',
        .              'CASSINI',   POS, <a href="../spicelib/ltime.html">LTIME</a>               )
 
   C
   C     Now compute the location of the antenna boresight
   C     at this same epoch.  From reading the frame kernel
   C     we know that the antenna boresight is nominally the
   C     +Z axis of the CASSINI_HGA frame defined there.
   C
         BSIGHT(1) = 0.0D0
         BSIGHT(2) = 0.0D0
         BSIGHT(3) = 1.0D0
 
   C
   C     Now compute the rotation matrix from CASSINI_HGA into
   C     J2000.
   C
         CALL <a href="../spicelib/pxform.html">PXFORM</a> ( 'CASSINI_HGA', 'J2000', ET, PFORM )
 
   C
   C     And multiply the result to obtain the nominal antenna
   C     boresight in the J2000 reference frame.
   C
         CALL <a href="../spicelib/mxv.html">MXV</a> ( PFORM, BSIGHT, BSIGHT )
 
   C
   C     Lastly compute the angular separation.
   C
         CALL <a href="../spicelib/convrt.html">CONVRT</a> ( <a href="../spicelib/vsep.html">VSEP</a>(BSIGHT, POS), 'RADIANS',
        .              'DEGREES',         SEP        )
 
         WRITE (*,*) '   Angular separation between the '
        .//          'apparent position of'
         WRITE (*,*) '      Earth and the CASSINI high '
        .//          'gain antenna boresight (degrees): '
         WRITE (*,'(A,F19.3)') '      ', SEP
 
   C
   C     Or, alternately we can work in the antenna
   C     frame directly.
   C
         CALL <a href="../spicelib/spkpos.html">SPKPOS</a> ( 'EARTH', ET,  'CASSINI_HGA', 'LT+S',
        .              'CASSINI',   POS, <a href="../spicelib/ltime.html">LTIME</a>              )
 
   C
   C     The antenna boresight is the Z-axis in the
   C     CASSINI_HGA frame.
   C
         BSIGHT(1) = 0.0D0
         BSIGHT(2) = 0.0D0
         BSIGHT(3) = 1.0D0
 
   C
   C     Lastly compute the angular separation.
   C
         CALL <a href="../spicelib/convrt.html">CONVRT</a> ( <a href="../spicelib/vsep.html">VSEP</a>(BSIGHT, POS), 'RADIANS',
        .              'DEGREES',         SEP        )
 
         WRITE (*,*) '   Angular separation between the '
        .//          'apparent position of'
         WRITE (*,*) '      Earth and the CASSINI high gain '
        .//          'antenna boresight computed '
         WRITE (*,*) '      using vectors in the CASSINI_HGA '
        .//          'frame (degrees): '
         WRITE (*,'(A,F19.3)') '      ', SEP
 
         END
</PRE>
<BR><BR>
<A NAME="Solution Sample Output1"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Sample Output
</H3><P><BR><BR>
   After compiling the program, execute it:
<P>
 
<PRE>
   Input UTC Time:  Converting UTC Time: 2004 JUN 11 19:32:00
      ET seconds past J2000:    140254384.185
       Apparent state of Phoebe as seen from CASSINI in the IAU_PHOEBE
          body-fixed frame (km, km/s):
         X =        -1982.639762
         Y =         -934.530471
         Z =         -166.562595
        VX =            3.970833
        VY =           -3.812498
        VZ =           -2.371663
       Apparent state of Phoebe as seen from CASSINI in the IAU_PHOEBE
          body-fixed frame (km, km/s) obtained using <a href="../spicelib/spkezr.html">SPKEZR</a> directly:
         X =        -1982.639762
         Y =         -934.530471
         Z =         -166.562595
        VX =            3.970832
        VY =           -3.812496
        VZ =           -2.371663
       Angular separation between the apparent position of
          Earth and the CASSINI high gain antenna boresight (degrees):
                      71.924
       Angular separation between the apparent position of
          Earth and the CASSINI high gain antenna boresight computed
          using vectors in the CASSINI_HGA frame (degrees):
                      71.924
</PRE>
<BR><BR>
<A NAME="Computing Sub-spacecraft and Sub-solar Points (subpts)"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H1> Computing Sub-spacecraft and Sub-solar Points (subpts)
</H1><HR SIZE=3 NOSHADE><P><BR><BR><BR>
<BR><BR>
<A NAME="Task Statement2"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Task Statement
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   Write a program that prompts the user for an input UTC time string,
   computes the following quantities at that epoch:
<P>
 
<UL>
<TT>1.</TT> The apparent sub-observer point of CASSINI on Phoebe in the body fixed
frame IAU_PHOEBE in kilometers.
<BR><BR></UL>
<UL>
<TT>2.</TT> The apparent sub-solar point on Phoebe as seen from CASSINI in the body
fixed frame IAU_PHOEBE in kilometers.
<BR><BR></UL>
   and displays the results. Use the program to compute these quantities at
   "2004 jun 11 19:32:00" UTC.
<P>
 
<BR><BR>
<A NAME="Learning Goals2"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Learning Goals
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   Discover higher level geometry calculation routines in SPICE and their
   usage as it relates to CASSINI.
<P>
 
<BR><BR>
<A NAME="Approach2"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Approach
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   This particular problem is more of an exercise in searching the permuted
   index to find the appropriate routines and then reading their headers to
   understand how to call them.
<P>
 
   One point worth considering: Which method do you want to use to compute
   the sub-solar (or sub-observer) point?
<P>
 
<BR><BR>
<A NAME="Solution2"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Solution
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
<BR><BR>
<A NAME="Solution Meta-Kernel2"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Meta-Kernel
</H3><P><BR><BR>
   The meta-kernel we created for the solution to this exercise is named
   'subpts.tm'. Its contents follow:
<P>
 
<PRE>
   KPL/MK
 
   This is the meta-kernel used in the solution of the
   ``Computing Sub-spacecraft and Sub-solar Points'' task
   in the Remote Sensing Hands On Lesson.
 
      \begindata
      KERNELS_TO_LOAD = ( 'kernels/lsk/naif0008.tls',
                          'kernels/spk/981005_PLTEPH-DE405S.bsp',
                          'kernels/spk/020514_SE_SAT105.bsp',
                          'kernels/spk/030201AP_SK_SM546_T45.bsp',
                          'kernels/pck/cpck05Mar2004.tpc' )
      \begintext
</PRE>
<BR><BR>
<A NAME="Solution Source Code2"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Source Code
</H3><P><BR><BR>
   A sample solution to the problem follows:
<P>
 
<PRE>
         PROGRAM SUBPTS
 
         IMPLICIT NONE
   C
   C     SPICELIB functions
   C
         DOUBLE PRECISION      <a href="../spicelib/vnorm.html">VNORM</a>
 
   C
   C     Local Parameters
   C
   C
   C     The name of the meta-kernel that lists the kernels
   C     to load into the program.
   C
         CHARACTER*(*)         METAKR
         PARAMETER           ( METAKR = 'subpts.tm' )
 
   C
   C     The length of various string variables.
   C
         INTEGER               STRLEN
         PARAMETER           ( STRLEN = 50 )
 
   C
   C     Local Variables
   C
         CHARACTER*(STRLEN)    UTCTIM
 
         DOUBLE PRECISION      ET
         DOUBLE PRECISION      SPOINT ( 3 )
         DOUBLE PRECISION      SRFVEC ( 3 )
         DOUBLE PRECISION      TRGEPC
 
   C
   C     Load the kernels that this program requires.  We
   C     will need:
   C
   C        A leapseconds kernel
   C        The necessary ephemerides
   C        A planetary constants file (PCK)
   C
         CALL <a href="../spicelib/furnsh.html">FURNSH</a> ( METAKR )
 
   C
   C     Prompt the user for the input time string.
   C
         CALL PROMPT ( 'Input UTC Time: ', UTCTIM )
 
         WRITE (*,*) 'Converting UTC Time: ', UTCTIM
 
   C
   C     Convert UTCTIM to ET.
   C
         CALL <a href="../spicelib/str2et.html">STR2ET</a> ( UTCTIM, ET )
 
         WRITE (*,'(A,F16.3)') '   ET seconds past J2000: ', ET
 
   C
   C     Compute the apparent sub-observer point of CASSINI on Phoebe.
   C
         CALL <a href="../spicelib/subpnt.html">SUBPNT</a> ( 'NEAR POINT: ELLIPSOID',
        .              'PHOEBE',  ET,     'IAU_PHOEBE', 'LT+S',
        .              'CASSINI', SPOINT, TRGEPC,       SRFVEC )
 
         WRITE (*,*) '   Apparent sub-observer point of CASSINI '
        .//          'on Phoebe in the'
         WRITE (*,*) '   IAU_PHOEBE frame (km):'
         WRITE (*,'(A,F16.3)') '      X = ', SPOINT(1)
         WRITE (*,'(A,F16.3)') '      Y = ', SPOINT(2)
         WRITE (*,'(A,F16.3)') '      Z = ', SPOINT(3)
         WRITE (*,'(A,F16.3)') '    ALT = ', <a href="../spicelib/vnorm.html">VNORM</a>(SRFVEC)
 
   C
   C     Compute the apparent sub-solar point on Phoebe as seen
   C     from CASSINI.
   C
         CALL <a href="../spicelib/subslr.html">SUBSLR</a> ( 'NEAR POINT: ELLIPSOID',
        .              'PHOEBE',  ET,     'IAU_PHOEBE', 'LT+S',
        .              'CASSINI', SPOINT, TRGEPC,       SRFVEC )
 
         WRITE (*,*) '   Apparent sub-solar point on Phoebe as '
        .//          'seen from CASSINI in'
         WRITE (*,*) '   the IAU_PHOEBE frame (km):'
         WRITE (*,'(A,F16.3)') '      X = ', SPOINT(1)
         WRITE (*,'(A,F16.3)') '      Y = ', SPOINT(2)
         WRITE (*,'(A,F16.3)') '      Z = ', SPOINT(3)
 
         END
</PRE>
<BR><BR>
<A NAME="Solution Sample Output2"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Sample Output
</H3><P><BR><BR>
   After compiling the program, execute it:
<P>
 
<PRE>
   Converting UTC Time: 2004 JUN 11 19:32:00
      ET seconds past J2000:    140254384.185
       Apparent sub-observer point of CASSINI on Phoebe in the
       IAU_PHOEBE frame (km):
         X =          104.498
         Y =           45.269
         Z =            7.383
       ALT =         2084.116
       Apparent sub-solar point on Phoebe as seen from CASSINI in
       the IAU_PHOEBE frame (km):
         X =           78.681
         Y =           76.879
         Z =          -21.885
</PRE>
<BR><BR>
<A NAME="Intersecting Vectors with a Triaxial Ellipsoid (fovint)"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H1> Intersecting Vectors with a Triaxial Ellipsoid (fovint)
</H1><HR SIZE=3 NOSHADE><P><BR><BR><BR>
<BR><BR>
<A NAME="Task Statement3"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Task Statement
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   Write a program that prompts the user for an input UTC time string and,
   for that time, computes the intersection of the CASSINI ISS NAC camera
   boresight and field of view (FOV) boundary vectors with the surface of
   Phoebe. The program presents each point of intersection as
<P>
 
<UL>
<TT>1.</TT> A cartesian vector in the IAU_PHOEBE frame
<BR><BR></UL>
<UL>
<TT>2.</TT> Planetocentric (latitudinal) coordinates in the IAU_PHOEBE frame.
<BR><BR></UL>
   For each vector, if an intersection is found, the program displays the
   results of the above computations, otherwise it indicates no
   intersection has occurred.
<P>
 
   At each point of intersection compute the following:
<P>
 
<UL>
<TT>3.</TT> Phase angle
<BR><BR></UL>
<UL>
<TT>4.</TT> Solar incidence angle
<BR><BR></UL>
<UL>
<TT>5.</TT> Emission angle
<BR><BR></UL>
   Additionally compute the local solar time at the intercept of the camera
   boresight with the surface of Phoebe.
<P>
 
   Use this program to compute values at the epoch:
<P>
 
<UL>
<TT>&#32;&#32;</TT> 2004 jun 11 19:32:00 UTC
<BR><BR></UL>
<BR><BR>
<A NAME="Learning Goals3"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Learning Goals
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   Understand how field of view parameters are retrieved from instrument
   kernels. Learn how various standard planetary constants are retrieved
   from text PCKs. Discover how to compute the intersection of field of
   view vectors with triaxial ellipsoidal target bodies. Discover another
   high level geometry routine and another time conversion routine in
   SPICE.
<P>
 
<BR><BR>
<A NAME="Approach3"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Approach
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
   This problem can be broken down into several simple, small steps:
<P>
 
<UL>
<TT>--</TT> Decide which SPICE kernels are necessary. Prepare a meta-kernel listing the
kernels and load it into the program. Remember, you will need to find a
kernel with information about the CASSINI NAC camera.
<BR><BR></UL>
<UL>
<TT>--</TT> Prompt the user for an input time string.
<BR><BR></UL>
<UL>
<TT>--</TT> Convert the input time string into ephemeris time expressed as seconds past
J2000 TDB.
<BR><BR></UL>
<UL>
<TT>--</TT> Retrieve the FOV (field of view) configuration for the CASSINI NAC camera.
<BR><BR></UL>
   For each vector in the set of boundary corner vectors, and for the
   boresight vector, perform the following operations:
<P>
 
<UL>
<TT>--</TT> Compute the intercept of the vector with Phoebe.
<BR><BR></UL>
<UL>
<TT>--</TT> If this intercept is found, convert the position vector of the intercept
into planetocentric coordinates.
<BR><BR></UL>
<UL>
<TT>&#32;&#32;</TT> Then compute the phase, solar incidence, and emission angles at the
intercept. Otherwise indicate to the user no intercept was found for this
vector.
<BR><BR></UL>
<UL>
<TT>--</TT> Compute the planetocentric longitude of the boresight intercept.
<BR><BR></UL>
   Finally
<P>
 
<UL>
<TT>--</TT> Compute the local solar time at the boresight intercept longitude on a
24-hour clock. The input time for this computation should be the TDB
observation epoch minus one-way light time from the boresight intercept to
the spacecraft.
<BR><BR></UL>
   It may be useful to consult the CASSINI ISS instrument kernel to
   determine the name of the NAC camera as well as its configuration. This
   exercise may make use of some of the concepts and (loosely) code from
   the ``Spacecraft Orientation and Reference Frames'' task.
<P>
 
<BR><BR>
<A NAME="Solution3"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H2> Solution
</H2><HR ALIGN="LEFT" WIDTH=50% ><P><BR><BR>
<BR><BR>
<A NAME="Solution Meta-Kernel3"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Meta-Kernel
</H3><P><BR><BR>
   The meta-kernel we created for the solution to this exercise is named
   'fovint.tm'. Its contents follow:
<P>
 
<PRE>
   KPL/MK
 
   This is the meta-kernel used in the solution of the
   ``Intersecting Vectors with a Triaxial Ellipsoid'' task
   in the Remote Sensing Hands On Lesson.
 
      \begindata
      KERNELS_TO_LOAD = ( 'kernels/lsk/naif0008.tls',
                          'kernels/sclk/cas00084.tsc',
                          'kernels/spk/981005_PLTEPH-DE405S.bsp',
                          'kernels/spk/020514_SE_SAT105.bsp',
                          'kernels/spk/030201AP_SK_SM546_T45.bsp',
                          'kernels/fk/cas_v37.tf',
                          'kernels/ck/04135_04171pc_psiv2.bc',
                          'kernels/pck/cpck05Mar2004.tpc',
                          'kernels/ik/cas_iss_v09.ti' )
      \begintext
</PRE>
<BR><BR>
<A NAME="Solution Source Code3"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Source Code
</H3><P><BR><BR>
   A sample solution to the problem follows:
<P>
 
<PRE>
         PROGRAM FOVINT
 
         IMPLICIT NONE
 
   C
   C     SPICELIB functions
   C
         DOUBLE PRECISION      <a href="../spicelib/dpr.html">DPR</a>
 
   C
   C     Local Parameters
   C
   C
   C     The name of the meta-kernel that lists the kernels
   C     to load into the program.
   C
         CHARACTER*(*)         METAKR
         PARAMETER           ( METAKR = 'fovint.tm' )
 
   C
   C     The length of various string variables.
   C
         INTEGER               STRLEN
         PARAMETER           ( STRLEN = 50 )
 
   C
   C     The maximum number of boundary corner vectors
   C     we can retrieve.
   C
         INTEGER               BCVLEN
         PARAMETER           ( BCVLEN = 5 )
 
   C
   C     Local Variables
   C
         CHARACTER*(STRLEN)    AMPM
         CHARACTER*(STRLEN)    INSFRM
         CHARACTER*(STRLEN)    SHAPE
         CHARACTER*(STRLEN)    TIME
         CHARACTER*(STRLEN)    UTCTIM
         CHARACTER*(STRLEN)    VECNAM ( BCVLEN )
 
         DOUBLE PRECISION      BOUNDS ( 3, BCVLEN )
         DOUBLE PRECISION      BSIGHT ( 3 )
         DOUBLE PRECISION      EMISSN
         DOUBLE PRECISION      ET
         DOUBLE PRECISION      LAT
         DOUBLE PRECISION      LON
         DOUBLE PRECISION      PHASE
         DOUBLE PRECISION      POINT  ( 3 )
         DOUBLE PRECISION      RADIUS
         DOUBLE PRECISION      SOLAR
         DOUBLE PRECISION      SRFVEC ( 3 )
         DOUBLE PRECISION      TRGEPC
 
         INTEGER               HR
         INTEGER               I
         INTEGER               MN
         INTEGER               N
         INTEGER               NACID
         INTEGER               PHOEID
         INTEGER               SC
 
         LOGICAL               FOUND
 
   C
   C     Load the kernels that this program requires. We
   C     will need:
   C
   C        A leapseconds kernel.
   C        A SCLK kernel for CASSINI.
   C        Any necessary ephemerides.
   C        The CASSINI frame kernel.
   C        A CASSINI C-kernel.
   C        A PCK file with Phoebe constants.
   C        The CASSINI ISS I-kernel.
   C
         CALL <a href="../spicelib/furnsh.html">FURNSH</a> ( METAKR )
 
   C
   C     Prompt the user for the input time string.
   C
         CALL PROMPT ( 'Input UTC Time: ', UTCTIM )
 
         WRITE (*,*) 'Converting UTC Time: ', UTCTIM
 
   C
   C     Convert UTCTIM to ET.
   C
         CALL <a href="../spicelib/str2et.html">STR2ET</a> ( UTCTIM, ET )
 
         WRITE (*,'(A,F16.3)') '   ET seconds past J2000: ', ET
 
   C
   C     Now we need to obtain the FOV configuration of the NAC
   C     camera. To do this we will need the ID code for
   C     CASSINI_ISS_NAC.
   C
         CALL <a href="../spicelib/bodn2c.html">BODN2C</a> ( 'CASSINI_ISS_NAC', NACID, FOUND )
 
   C
   C     Stop the program if the code was not found.
   C
         IF ( .NOT. FOUND ) THEN
            WRITE (*,*) 'Unable to locate the ID code for '
        .   //          'CASSINI_ISS_NAC'
            CALL BYEBYE ( 'FAILURE' )
         END IF
 
   C
   C     Now retrieve the field of view parameters.
   C
         CALL <a href="../spicelib/getfov.html">GETFOV</a> ( NACID,  BCVLEN, SHAPE, INSFRM,
        .              BSIGHT, N,      BOUNDS        )
 
   C
   C     Rather than treat BSIGHT as a separate vector,
   C     copy it into the last slot of BOUNDS.
   C
         CALL MOVED ( BSIGHT, 3, BOUNDS(1,5) )
 
   C
   C     Define names for each of the vectors for display
   C     purposes.
   C
         VECNAM (1) = 'Boundary Corner 1'
         VECNAM (2) = 'Boundary Corner 2'
         VECNAM (3) = 'Boundary Corner 3'
         VECNAM (4) = 'Boundary Corner 4'
         VECNAM (5) = 'Cassini NAC Boresight'
 
   C
   C     Now perform the same set of calculations for each
   C     vector listed in the BOUNDS array.
   C
         DO I = 1, 5
   C
   C        Call <a href="../spicelib/sincpt.html">SINCPT</a> to determine coordinates of the
   C        intersection of this vector with the surface
   C        of Phoebe.
   C
            CALL <a href="../spicelib/sincpt.html">SINCPT</a> ( 'Ellipsoid',  'PHOEBE',    ET,
        .                 'IAU_PHOEBE', 'LT+S',      'CASSINI',
        .                 INSFRM,       BOUNDS(1,I), POINT,
        .                 TRGEPC,       SRFVEC,      FOUND    )
   C
   C        Check the found flag. Display a message if the point
   C        of intersection was not found, otherwise continue with
   C        the calculations.
   C
            WRITE (*,*) 'Vector: ', VECNAM(I)
 
            IF ( .NOT. FOUND ) THEN
 
               WRITE (*,*) 'No intersection point found at '
        .      //          'this epoch for this vector.'
 
            ELSE
   C
   C           Now, we have discovered a point of intersection.
   C           Start by displaying the position vector in the
   C           IAU_PHOEBE frame of the intersection.
   C
               WRITE (*,*) '  Position vector of '
        .      //          'surface intercept in '
        .      //          'the IAU_PHOEBE frame (km):'
               WRITE (*,'(A,F16.3)') '      X   = ', POINT(1)
               WRITE (*,'(A,F16.3)') '      Y   = ', POINT(2)
               WRITE (*,'(A,F16.3)') '      Z   = ', POINT(3)
   C
   C           Display the planetocentric latitude and longitude
   C           of the intercept.
   C
               CALL <a href="../spicelib/reclat.html">RECLAT</a> ( POINT, RADIUS, LON, LAT )
 
               WRITE (*,*) '  Planetocentric coordinates of the '
        .      //          'intercept (degrees):'
               WRITE (*,'(A,F16.3)') '      LAT = ', LAT * <a href="../spicelib/dpr.html">DPR</a>()
               WRITE (*,'(A,F16.3)') '      LON = ', LON * <a href="../spicelib/dpr.html">DPR</a>()
   C
   C           Compute the illumination angles at this
   C           point.
   C
               CALL <a href="../spicelib/ilumin.html">ILUMIN</a> ( 'Ellipsoid',  'PHOEBE',  ET,
        .                    'IAU_PHOEBE', 'LT+S',    'CASSINI',
        .                    POINT,        TRGEPC,    SRFVEC,
        .                    PHASE,        SOLAR,     EMISSN    )
 
               WRITE (*,'(A,F16.3)') '   Phase angle (degrees):'
        .      //                    '           ', PHASE * <a href="../spicelib/dpr.html">DPR</a>()
               WRITE (*,'(A,F16.3)') '   Solar incidence angle '
        .      //                    '(degrees): ', SOLAR * <a href="../spicelib/dpr.html">DPR</a>()
               WRITE (*,'(A,F16.3)') '   Emission angle (degree'
        .      //                    's):        ', EMISSN* <a href="../spicelib/dpr.html">DPR</a>()
 
            END IF
 
            WRITE (*,*) ' '
 
         END DO
 
   C
   C     Lastly compute the local solar time at the boresight
   C     intersection.
   C
         IF ( FOUND ) THEN
   C
   C        Get Phoebe ID.
   C
            CALL <a href="../spicelib/bodn2c.html">BODN2C</a> ( 'PHOEBE', PHOEID, FOUND )
   C
   C        Stop the program if the code was not found.
   C
            IF ( .NOT. FOUND ) THEN
               WRITE (*,*) 'Unable to locate the ID code for '
        .   //             'PHOEBE'
               CALL BYEBYE ( 'FAILURE' )
            END IF
   C
   C        Compute local time corresponding to the TDB light time
   C        corrected epoch at the intercept.
   C
            CALL <a href="../spicelib/et2lst.html">ET2LST</a> ( TRGEPC,
        .                 PHOEID,
        .                 LON,
        .                 'PLANETOCENTRIC',
        .                 HR,
        .                 MN,
        .                 SC,
        .                 TIME,
        .                 AMPM              )
 
            WRITE (*,*) '  Local Solar Time at boresight '
        .   //          'intercept (24 Hour Clock): '
            WRITE (*,*) '     ', TIME
 
         ELSE
 
            WRITE (*,*) '   No boresight intercept to compute '
        .   //          'local solar time.'
 
         END IF
 
         END
</PRE>
<BR><BR>
<A NAME="Solution Sample Output3"></A>
<p align="right"><a href="#top"><small>Top</small></a></p>
<H3> Solution Sample Output
</H3><P><BR><BR>
   After compiling the program, execute it:
<P>
 
<PRE>
   Converting UTC Time: 2004 JUN 11 19:32:00
      ET seconds past J2000:    140254384.185
    Vector: Boundary Corner 1
      Position vector of surface intercept in the IAU_PHOEBE frame (km):
         X   =           91.026
         Y   =           67.190
         Z   =            2.030
      Planetocentric coordinates of the intercept (degrees):
         LAT =            1.028
         LON =           36.433
      Phase angle (degrees):                     28.110
      Solar incidence angle (degrees):           16.121
      Emission angle (degrees):                  14.627
 
    Vector: Boundary Corner 2
      Position vector of surface intercept in the IAU_PHOEBE frame (km):
         X   =           89.991
         Y   =           66.726
         Z   =           14.733
      Planetocentric coordinates of the intercept (degrees):
         LAT =            7.492
         LON =           36.556
      Phase angle (degrees):                     27.894
      Solar incidence angle (degrees):           22.894
      Emission angle (degrees):                  14.988
 
    Vector: Boundary Corner 3
      Position vector of surface intercept in the IAU_PHOEBE frame (km):
         X   =           80.963
         Y   =           76.643
         Z   =           14.427
      Planetocentric coordinates of the intercept (degrees):
         LAT =            7.373
         LON =           43.430
      Phase angle (degrees):                     28.171
      Solar incidence angle (degrees):           21.315
      Emission angle (degrees):                  21.977
 
    Vector: Boundary Corner 4
      Position vector of surface intercept in the IAU_PHOEBE frame (km):
         X   =           81.997
         Y   =           77.106
         Z   =            1.699
      Planetocentric coordinates of the intercept (degrees):
         LAT =            0.865
         LON =           43.239
      Phase angle (degrees):                     28.385
      Solar incidence angle (degrees):           13.882
      Emission angle (degrees):                  21.763
 
    Vector: Cassini NAC Boresight
      Position vector of surface intercept in the IAU_PHOEBE frame (km):
         X   =           86.390
         Y   =           72.089
         Z   =            8.255
      Planetocentric coordinates of the intercept (degrees):
         LAT =            4.196
         LON =           39.844
      Phase angle (degrees):                     28.139
      Solar incidence angle (degrees):           18.247
      Emission angle (degrees):                  17.858
 
      Local Solar Time at boresight intercept (24 Hour Clock):
         11:31:50
</PRE>

</TD>
</TR>
</TBODY>
</TABLE>

</BODY>

</HTML>
